<div ng-controller="repoController">

    <div class="section-medium bg-light">
        <div class="uk-container uk-container-center">
            <h2>{{ .params.user }} / {{ .params.repo }}</h2>
            <button class="uk-button" ng-class="{'uk-button-success': okHook.data.hook != null, 'uk-button-danger': okHook.data.error != null}" ng-click="setHook('{{ .params.user }}', '{{ .params.repo }}')">
                <i class="uk-icon-github"></i> Set github hook
            </button>
        </div>
    </div>
    <div class="section-medium">
        <div class="uk-container uk-container-center ">

            <table class="uk-table uk-table-striped">
                <caption>Events</caption>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Status</th>
                        <th>Commit</th>
                        <th>Build Id</th>
                        <th>Time</th>
                    </tr>
                </thead>
                <tbody>
                    {{ range $index, $build := .builds }}
                    <tr {{if $.params.build}}{{if eq $.params.build $build.GetId}} class="uk-text-bold"{{end}}{{end}}>
                        <td>{{$index}}</td>
                        <td>
                            {{if $build.Success}}
                            <span class="uk-text-success">Success</span>
                            {{else}}
                            <span class="uk-text-danger">Fail</span>
                            {{end}}
                        </td>
                        <td>
                            <a target="_blank" href="https://github.com/{{ $build.Branch.Owner }}/{{ $build.Branch.Repo }}/commit/{{ $build.Branch.Sha }}">
                                <i class="uk-icon-github"></i>
                            </a>
                            {{ $build.Branch.Sha }}
                        </td>
                        <td>
                            <a href="/repos/{{ $build.Branch.Owner }}/{{ $build.Branch.Repo }}/{{ $build.GetId }}">
                                {{ $build.GetId }}
                            </a>
                        </td>
                        <td>
                            {{ $build.Time }}
                        </td>
                    </tr>
                    {{ end }}
                </tbody>
            </table>

            {{ if .build.Commands }}
            <table class="uk-table uk-margin-large-top bg-black text-white uk-table-condensed">
                <thead class="bg-dark">
                    <tr>
                        <th width="15%">Build log</th>
                    </tr>
                </thead>
                <tbody>
                    {{ range $a, $build := .build.Commands }}
                    <tr>
                        <td>> {{ $build.Type }}: {{ $build.Action }}</td>
                    </tr>
                    <tr>
                        <td>
                            {{ $build.Out }}
                            <span class="uk-text-danger">{{ $build.Err }}</span>
                        </td>
                    </tr>
                    {{ end }}
                </tbody>
            </table>
            {{end}}

        </div>
    </div>

</div>